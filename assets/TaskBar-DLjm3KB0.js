import{v as D}from"./v4-CtRu48qb.js";import{j as n}from"./jsx-runtime-DF2Pcvd1.js";import{r as p}from"./index-B2-qRKKC.js";import{f,A as M}from"./timeline.constants-Dto3cMpA.js";const{addons:S}=__STORYBOOK_MODULE_PREVIEW_API__,{ImplicitActionsDuringRendering:A}=__STORYBOOK_MODULE_CORE_EVENTS_PREVIEW_ERRORS__,{global:E}=__STORYBOOK_MODULE_GLOBAL__;var C=Object.defineProperty,N=(e,t)=>{for(var r in t)C(e,r,{get:t[r],enumerable:!0})},I="storybook/actions",P=`${I}/action-event`,L={depth:10,clearOnStoryChange:!0,limit:50},T=(e,t)=>{let r=Object.getPrototypeOf(e);return!r||t(r)?r:T(r,t)},B=e=>!!(typeof e=="object"&&e&&T(e,t=>/^Synthetic(?:Base)?Event$/.test(t.constructor.name))&&typeof e.persist=="function"),z=e=>{if(B(e)){let t=Object.create(e.constructor.prototype,Object.getOwnPropertyDescriptors(e));t.persist();let r=Object.getOwnPropertyDescriptor(t,"view"),o=r==null?void 0:r.value;return typeof o=="object"&&(o==null?void 0:o.constructor.name)==="Window"&&Object.defineProperty(t,"view",{...r,value:Object.create(o.constructor.prototype)}),t}return e},K=()=>typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?D():Date.now().toString(36)+Math.random().toString(36).substring(2);function x(e,t={}){let r={...L,...t},o=function(...i){var g,m;if(t.implicit){let h=(g="__STORYBOOK_PREVIEW__"in E?E.__STORYBOOK_PREVIEW__:void 0)==null?void 0:g.storyRenders.find(c=>c.phase==="playing"||c.phase==="rendering");if(h){let c=!((m=globalThis==null?void 0:globalThis.FEATURES)!=null&&m.disallowImplicitActionsInRenderV8),_=new A({phase:h.phase,name:e,deprecated:c});if(c)console.warn(_);else throw _}}let a=S.getChannel(),l=K(),d=5,u=i.map(z),y=i.length>1?u:u[0],b={id:l,count:0,data:{name:e,args:y},options:{...r,maxDepth:d+(r.depth||3),allowFunction:r.allowFunction||!1}};a.emit(P,b)};return o.isAction=!0,o.implicit=t.implicit,o}const{definePreview:X}=__STORYBOOK_MODULE_PREVIEW_API__,{global:O}=__STORYBOOK_MODULE_GLOBAL__;var V={};N(V,{argsEnhancers:()=>Y,loaders:()=>q});var j=(e,t)=>typeof t[e]>"u"&&!(e in t),k=e=>{let{initialArgs:t,argTypes:r,id:o,parameters:{actions:i}}=e;if(!i||i.disable||!i.argTypesRegex||!r)return{};let a=new RegExp(i.argTypesRegex);return Object.entries(r).filter(([l])=>!!a.test(l)).reduce((l,[d,u])=>(j(d,t)&&(l[d]=x(d,{implicit:!0,id:o})),l),{})},$=e=>{let{initialArgs:t,argTypes:r,parameters:{actions:o}}=e;return o!=null&&o.disable||!r?{}:Object.entries(r).filter(([i,a])=>!!a.action).reduce((i,[a,l])=>(j(a,t)&&(i[a]=x(typeof l.action=="string"?l.action:a)),i),{})},Y=[$,k],w=!1,W=e=>{let{parameters:{actions:t}}=e;if(!(t!=null&&t.disable)&&!w&&"__STORYBOOK_TEST_ON_MOCK_CALL__"in O&&typeof O.__STORYBOOK_TEST_ON_MOCK_CALL__=="function"){let r=O.__STORYBOOK_TEST_ON_MOCK_CALL__;r((o,i)=>{let a=o.getMockName();a!=="spy"&&(!/^next\/.*::/.test(a)||["next/router::useRouter()","next/navigation::useRouter()","next/navigation::redirect","next/cache::","next/headers::cookies().set","next/headers::cookies().delete","next/headers::headers().set","next/headers::headers().delete"].some(l=>a.startsWith(l)))&&x(a)(i)}),w=!0}},q=[W];const R=({task:e,style:t,isSelected:r,isDragging:o,onClick:i,onMouseDown:a})=>{const[l,d]=p.useState(!1),u=p.useCallback(()=>{d(!0)},[]),y=p.useCallback(()=>{d(!1)},[]),b=p.useCallback(s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),i())},[i]),g=p.useCallback(s=>{s.preventDefault(),s.stopPropagation(),i()},[i]),m=p.useCallback((s,v)=>{s.preventDefault(),s.stopPropagation(),a(s,v==="left"?"resize-left":"resize-right")},[a]),h=p.useCallback(s=>{s.target.classList.contains("resize-handle")||(s.preventDefault(),s.stopPropagation(),a(s,"move"))},[a]),c=Math.max(0,Math.min(100,e.progress)),_=e.color||"#0ea5e9";return n.jsxs("div",{className:`task-bar group relative rounded cursor-move transition-all duration-200 select-none ${r?"ring-2 ring-primary-500 ring-offset-1":""} ${o?"shadow-lg":"shadow-sm hover:shadow-md"}`,style:{...t,backgroundColor:_,opacity:o?.8:1},role:M.TASK_ROLE,tabIndex:0,"aria-label":`${e.title}. From ${f(e.startDate)} to ${f(e.endDate)}. Progress: ${c}%. Press Enter to edit.`,"aria-describedby":`task-${e.id}-tooltip`,onMouseEnter:u,onMouseLeave:y,onKeyDown:b,onClick:g,onMouseDown:h,children:[n.jsxs("div",{className:"flex items-center justify-between h-full px-2 py-1",children:[n.jsx("span",{className:"text-xs font-medium text-white truncate flex-1 mr-1",children:e.title}),!e.isMilestone&&n.jsxs("span",{className:"text-xs text-white opacity-75 flex-shrink-0",children:[c,"%"]})]}),!e.isMilestone&&c>0&&n.jsx("div",{className:"absolute bottom-0 left-0 h-1 bg-white opacity-40 rounded-b transition-all duration-300",style:{width:`${c}%`},"aria-hidden":"true"}),n.jsx("div",{className:"resize-handle absolute left-0 top-0 bottom-0 w-2 cursor-ew-resize opacity-0 group-hover:opacity-50 hover:!opacity-100 transition-opacity bg-white rounded-l",onMouseDown:s=>m(s,"left"),"aria-label":"Resize task start date",role:"button",tabIndex:-1}),n.jsx("div",{className:"resize-handle absolute right-0 top-0 bottom-0 w-2 cursor-ew-resize opacity-0 group-hover:opacity-50 hover:!opacity-100 transition-opacity bg-white rounded-r",onMouseDown:s=>m(s,"right"),"aria-label":"Resize task end date",role:"button",tabIndex:-1}),e.isMilestone&&n.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:n.jsx("div",{className:"w-4 h-4 transform rotate-45 border-2 border-white",style:{backgroundColor:_},"aria-label":"Milestone"})}),l&&n.jsxs("div",{id:`task-${e.id}-tooltip`,className:"absolute z-50 px-2 py-1 text-xs text-white bg-neutral-900 rounded shadow-lg pointer-events-none animate-fade-in",style:{bottom:"100%",left:"50%",transform:"translateX(-50%)",marginBottom:"4px",maxWidth:"200px"},role:"tooltip",children:[n.jsx("div",{className:"font-medium",children:e.title}),n.jsxs("div",{className:"opacity-75",children:[f(e.startDate,"short")," - ",f(e.endDate,"short")]}),e.assignee&&n.jsxs("div",{className:"opacity-75",children:["Assigned to: ",e.assignee]}),!e.isMilestone&&n.jsxs("div",{className:"opacity-75",children:["Progress: ",c,"%"]}),n.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-2 border-r-2 border-t-2 border-transparent border-t-neutral-900"})]})]})};try{R.displayName="TaskBar",R.__docgenInfo={description:"",displayName:"TaskBar",props:{task:{defaultValue:null,description:"",name:"task",required:!0,type:{name:"TimelineTask"}},style:{defaultValue:null,description:"",name:"style",required:!0,type:{name:"CSSProperties"}},isSelected:{defaultValue:null,description:"",name:"isSelected",required:!0,type:{name:"boolean"}},isDragging:{defaultValue:null,description:"",name:"isDragging",required:!0,type:{name:"boolean"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"() => void"}},onMouseDown:{defaultValue:null,description:"",name:"onMouseDown",required:!0,type:{name:'(event: MouseEvent<Element, MouseEvent>, dragType: "move" | "resize-left" | "resize-right") => void'}}}}}catch{}export{R as T,x as a};
